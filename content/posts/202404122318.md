+++
title = "Emacs 30で導入される予定のおもしろい機能の紹介"
date = 2024-04-12T23:25:00+09:00
draft = false
archives = ["""
  "2024"
  """, """
  "2024-04"
  """]
+++

Emacs29もリリースされてしばらくたち、Emacs30の開発も進んでいます。

NEWSを見てみると、正当なうれしい機能だけでなく、ユースケースが不思議なおもしろい機能も増えているので、
それらをご紹介したいと思います。

真面目なアップデート紹介については、別でやりたいと思います。
Emacs29が出たときも以下の記事を書いてたら、まるでこれらだけが新機能のように受け取られてしまって、すまぬ、、、と思ったので。

[Emacs 29で導入される予定のおもしろい機能の紹介]({{< relref "202211242303" >}})


## パスワード文字列の表示切替 {#パスワード文字列の表示切替}

`read-passwd` はパスワードの入力を受け付けるためのコマンドです。
通常は、入力したものが表示されずマスクされて表示されます。

Emacs30からは、入力中にタブキーを押す、もしくは左端の目のアイコンをクリックすることでマスク表示の切替ができるようになりました。

{{< figure src="/ox-hugo/20240412-emacs30-passwd.png" >}}

タブキーでも切り替わってしまうということで、うっかりパスワードを人に見られないように注意が必要かもしれませんね。


## modifier-bar-mode - 修飾キーをツールバーで切替 {#modifier-bar-mode-修飾キーをツールバーで切替}

新しいマイナーモードとして、 `modifier-bar-mode` なるものが追加されました。
これを有効化するとツールバーに修飾キーを示す表示が追加されます。

{{< figure src="/ox-hugo/20240412-emacs30-modifier-bar-mode.png" >}}

こちらですが、修飾キーの状態を示すのではなく、なんとクリックすることで修飾キーの入力状態を切り替えることができます。

例えばCtrlと書かれた部分をクリックしてから <kbd>a</kbd> を入力すると <kbd>C-a</kbd> を入力したのと同じ扱いになるということです。

まったくユースケースが思いつかないのですが、私は以下のようにしてWindowsでもSuper/Hyperキーを使えるようにしているのですが、
それができない場合にこれを使うことでSuper/Hyperキーを使ったキーバインドを実現できるかもしれませんね。

[emacs on WSLでSuper/Hyperキーを使う]({{< relref "201910040445" >}})


## ツールバーを下に配置 {#ツールバーを下に配置}

フレームの設定に `tool-bar-position` が増え、 `bottom` を設定することでツールバーが下に配置できるようになりました。

```emacs-lisp
(setq default-frame-alist
      (append '((tool-bar-position . bottom)
                )
              default-frame-alist))
(setq initial-frame-alist default-frame-alist)
```

{{< figure src="/ox-hugo/20240412-emacs30-toolbar-bottom.png" >}}

たしかに下に配置されてますね。普段ツールバー使わないので色合いのギャップがひどいですが、ご愛嬌ということで。


## まとめ {#まとめ}

Emacs30でちょっと変わった機能を紹介しました。

マジメな変更点として、 `defadvise` がついに非推奨になったり後方互換に関するトピックもあるので、それは別途紹介したいと思います。
